SF_Ratios.py   @Jody Hey 2024
========================
Command line: -a testbed_lognormal_data.txt -f foldit -d lognormal -i 1 -m 1 -c 1 -y -r 2024-10-11 -p test11
Arguments:
	sfsfilename: testbed_lognormal_data.txt
	fix_theta_ratio: 1.0
	densityof2Ns: lognormal
	foldstatus: foldit
	basinhoppingopt: False
	optimizetries: 1
	setmax2Ns: 1.0
	poplabel: test11
	estimatemax2Ns: False
	outdir: 2024-10-11
	estimate_pointmass: True
	filecheck: False
	commandstring: -a testbed_lognormal_data.txt -f foldit -d lognormal -i 1 -m 1 -c 1 -y -r 2024-10-11 -p test11
	maxi: None
	fixmode0: False
	estimate_pointmass0: False
	thetaNspacerange: 100
	profile: False
	estimate_both_thetas: False
	includemisspec: False
	dofolded: True
	nc: 200
	datafileheader: Generated by simulate_WF_SFSs_for_SF_Ratios.py. nc: 200 density: lognormal parameters: [3, 1.2] thetaN: 10000  thetaS: 10000  unfolded
	numparams: 4
	optimizemethod: Nelder-Mead

trial	likelihood	mu	sigma	pm_mass	pm_val
0	1332.4	2.9718 1.9443 0.5 -20

Maximized Likelihood and Parameter Estimates:
	result.message: Optimize
	Numerical integration of lognormal distribution check: 1.5  (near 1 is good, large departures from 1 suggest a numerical integration difficulty)
AIC	-2656.725
likelihood	1332.362
mu	2.9718	(2.9306 - 3.0173)
sigma	1.9443	(1.6242 - 1.9864)
pm_mass	0.5	(0.4591 - 0.50782)
pm_val	-20	(nan - -17.351)
expectation	-74.137
mode	0.555

Compare data and optimization estimates
	Euclidean Distance: 0.2427 RMSE: 0.02427
	*Expected counts generated with Wright-Fisher theta estimates (Poisson-Random-Field-Ratio does not provide theta estimates)
---------------------------------------------------------------------------------------------------------------------------
i	DataN	DataS	DataRatio	Fit*_N	Fit*_S	Fit_Ratio
0	0.0	0.0	inf	0.0	0.0	inf
1	10034.0	7931.0	0.7904	10013.2	8307.4	0.8296
2	5058.0	3274.0	0.6473	5031.9	3602.1	0.7159
3	3372.0	1805.0	0.5353	3371.6	2113.4	0.6268
4	2505.0	1242.0	0.4958	2541.6	1406.7	0.5535
5	2027.0	908.0	0.448	2043.7	1004.8	0.4916
6	1734.0	640.0	0.3691	1711.9	751.4	0.4389
7	1438.0	515.0	0.3581	1474.9	580.6	0.3937
8	1268.0	418.0	0.3297	1297.3	460.0	0.3546
9	1203.0	355.0	0.2951	1159.2	371.9	0.3208
10	1092.0	330.0	0.3022	1048.8	305.6	0.2914
11	959.0	218.0	0.2273	958.5	254.8	0.2658
12	877.0	216.0	0.2463	883.3	215.0	0.2434
13	782.0	183.0	0.234	819.7	183.5	0.2238
14	750.0	165.0	0.22	765.2	158.1	0.2066
15	677.0	146.0	0.2157	718.1	137.5	0.1915
16	678.0	126.0	0.1858	676.8	120.5	0.1781
17	659.0	118.0	0.1791	640.5	106.5	0.1662
18	606.0	109.0	0.1799	608.3	94.7	0.1557
19	604.0	96.0	0.1589	579.4	84.8	0.1463
20	524.0	88.0	0.1679	553.5	76.4	0.138
21	551.0	85.0	0.1543	530.1	69.2	0.1305
22	525.0	84.0	0.16	508.8	63.0	0.1238
23	482.0	73.0	0.1515	489.5	57.6	0.1178
24	477.0	48.0	0.1006	471.7	53.0	0.1123
25	454.0	53.0	0.1167	455.5	48.9	0.1074
26	429.0	48.0	0.1119	440.5	45.4	0.103
27	427.0	45.0	0.1054	426.6	42.2	0.09896
28	388.0	46.0	0.1186	413.8	39.4	0.0953
29	417.0	36.0	0.08633	401.8	37.0	0.09197
30	412.0	39.0	0.09466	390.7	34.7	0.08893
31	355.0	35.0	0.09859	380.3	32.8	0.08614
32	362.0	33.0	0.09116	370.7	31.0	0.0836
33	375.0	30.0	0.08	361.6	29.4	0.08126
34	346.0	31.0	0.0896	353.1	27.9	0.07911
35	363.0	27.0	0.07438	345.0	26.6	0.07714
36	328.0	31.0	0.09451	337.5	25.4	0.07531
37	351.0	33.0	0.09402	330.4	24.3	0.07363
38	322.0	23.0	0.07143	323.7	23.3	0.07207
39	342.0	25.0	0.0731	317.3	22.4	0.07063
40	327.0	34.0	0.104	311.3	21.6	0.0693
41	300.0	16.0	0.05333	305.7	20.8	0.06806
42	351.0	20.0	0.05698	300.3	20.1	0.06691
43	283.0	20.0	0.07067	295.2	19.4	0.06584
44	307.0	21.0	0.0684	290.3	18.8	0.06484
45	268.0	23.0	0.08582	285.7	18.3	0.06391
46	285.0	18.0	0.06316	281.3	17.7	0.06304
47	260.0	15.0	0.05769	277.1	17.2	0.06222
48	279.0	13.0	0.04659	273.1	16.8	0.06146
49	277.0	21.0	0.07581	269.3	16.4	0.06075
50	272.0	16.0	0.05882	265.7	16.0	0.06008
51	242.0	23.0	0.09504	262.2	15.6	0.05946
52	257.0	12.0	0.04669	258.9	15.2	0.05887
53	243.0	11.0	0.04527	255.8	14.9	0.05832
54	268.0	9.0	0.03358	252.7	14.6	0.0578
55	235.0	13.0	0.05532	249.9	14.3	0.05731
56	257.0	12.0	0.04669	247.1	14.0	0.05685
57	249.0	12.0	0.04819	244.5	13.8	0.05641
58	257.0	12.0	0.04669	241.9	13.5	0.056
59	223.0	15.0	0.06726	239.5	13.3	0.05562
60	225.0	5.0	0.02222	237.2	13.1	0.05525
61	245.0	17.0	0.06939	235.0	12.9	0.0549
62	200.0	14.0	0.07	232.9	12.7	0.05458
63	217.0	15.0	0.06912	230.9	12.5	0.05427
64	228.0	10.0	0.04386	228.9	12.4	0.05398
65	200.0	11.0	0.055	227.1	12.2	0.0537
66	244.0	10.0	0.04098	225.3	12.0	0.05344
67	236.0	15.0	0.06356	223.6	11.9	0.05319
68	216.0	9.0	0.04167	222.0	11.8	0.05296
69	243.0	12.0	0.04938	220.4	11.6	0.05274
70	215.0	12.0	0.05581	219.0	11.5	0.05253
71	201.0	12.0	0.0597	217.6	11.4	0.05233
72	203.0	6.0	0.02956	216.2	11.3	0.05214
73	175.0	5.0	0.02857	214.9	11.2	0.05196
74	190.0	7.0	0.03684	213.7	11.1	0.05179
75	209.0	13.0	0.0622	212.5	11.0	0.05163
76	233.0	13.0	0.05579	211.4	10.9	0.05148
77	219.0	8.0	0.03653	210.4	10.8	0.05134
78	205.0	8.0	0.03902	209.4	10.7	0.05121
79	198.0	19.0	0.09596	208.5	10.6	0.05108
80	207.0	8.0	0.03865	207.6	10.6	0.05096
81	207.0	10.0	0.04831	206.7	10.5	0.05085
82	166.0	16.0	0.09639	205.9	10.5	0.05075
83	213.0	9.0	0.04225	205.2	10.4	0.05065
84	208.0	9.0	0.04327	204.5	10.3	0.05056
85	213.0	6.0	0.02817	203.9	10.3	0.05047
86	195.0	11.0	0.05641	203.2	10.2	0.05039
87	208.0	4.0	0.01923	202.7	10.2	0.05032
88	219.0	11.0	0.05023	202.2	10.2	0.05026
89	205.0	8.0	0.03902	201.7	10.1	0.05019
90	218.0	11.0	0.05046	201.3	10.1	0.05014
91	213.0	9.0	0.04225	200.9	10.1	0.05009
92	205.0	5.0	0.02439	200.5	10.0	0.05005
93	218.0	4.0	0.01835	200.2	10.0	0.05001
94	194.0	4.0	0.02062	200.0	10.0	0.04997
95	207.0	7.0	0.03382	199.8	10.0	0.04995
96	202.0	2.0	0.009901	199.6	10.0	0.04992
97	200.0	7.0	0.035	199.4	10.0	0.04991
98	223.0	7.0	0.03139	199.3	9.9	0.04989
99	211.0	3.0	0.01422	199.3	9.9	0.04988
100	87.0	2.0	0.02299	99.6	5.0	0.04988

Caching results:
coth cache: CacheInfo(hits=3429156, misses=18555, maxsize=100000, currsize=18555)
erf cache: CacheInfo(hits=127821, misses=3649579, maxsize=100000, currsize=100000)
hyp1f1 cache: CacheInfo(hits=3150966, misses=3692445, maxsize=5000000, currsize=3692445)

Time taken: 0 hours, 14 minutes, 26.14 seconds

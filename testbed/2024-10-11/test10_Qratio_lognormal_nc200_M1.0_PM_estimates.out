SF_Ratios.py   @Jody Hey 2024
========================
Command line: -a testbed_lognormal_pm_data.txt -f foldit -d lognormal -i 1 -m 1 -y -r 2024-10-11 -p test10
Arguments:
	sfsfilename: testbed_lognormal_pm_data.txt
	fix_theta_ratio: None
	densityof2Ns: lognormal
	foldstatus: foldit
	basinhoppingopt: False
	optimizetries: 1
	setmax2Ns: 1.0
	poplabel: test10
	estimatemax2Ns: False
	outdir: 2024-10-11
	estimate_pointmass: True
	filecheck: False
	commandstring: -a testbed_lognormal_pm_data.txt -f foldit -d lognormal -i 1 -m 1 -y -r 2024-10-11 -p test10
	maxi: None
	fixmode0: False
	estimate_pointmass0: False
	thetaNspacerange: 100
	profile: False
	estimate_both_thetas: False
	includemisspec: False
	dofolded: True
	nc: 200
	datafileheader: Generated by simulate_WF_SFSs_for_SF_Ratios.py. nc: 200 density: lognormal parameters: [3, 1.2] thetaN: 10000  thetaS: 10000  point mass location: 0.4  point mass value: -1  unfolded
	numparams: 5
	optimizemethod: Nelder-Mead

trial	likelihood	thetaratio	mu	sigma	pm_mass	pm_val
0	1305.6	0.90174 1.8073 1.205 0.078817 -0.54687

Maximized Likelihood and Parameter Estimates:
	result.message: Optimize
	Numerical integration of lognormal distribution check: 1  (near 1 is good, large departures from 1 suggest a numerical integration difficulty)
AIC	-2601.269
likelihood	1305.634
thetaratio	0.9017	(0.8927 - 0.9101)
mu	1.8073	(1.786 - 1.8319)
sigma	1.205	(1.158 - 1.2482)
pm_mass	0.078817	(0.066167 - 0.090228)
pm_val	-0.54687	(-0.84498 - -0.33199)
expectation	-10.726
mode	-0.426

Compare data and optimization estimates
	Euclidean Distance: 0.3865 RMSE: 0.03865
	*Expected counts generated with Wright-Fisher theta estimates (Poisson-Random-Field-Ratio does not provide theta estimates)
---------------------------------------------------------------------------------------------------------------------------
i	DataN	DataS	DataRatio	Fit*_N	Fit*_S	Fit_Ratio
0	0.0	0.0	inf	0.0	0.0	inf
1	10034.0	8748.0	0.8718	10013.2	8322.3	0.8311
2	5058.0	3930.0	0.777	5031.9	3902.6	0.7756
3	3372.0	2347.0	0.696	3371.6	2461.3	0.73
4	2505.0	1724.0	0.6882	2541.6	1757.8	0.6916
5	2027.0	1337.0	0.6596	2043.7	1345.9	0.6585
6	1734.0	1015.0	0.5854	1711.9	1078.0	0.6297
7	1438.0	857.0	0.596	1474.9	891.1	0.6042
8	1268.0	733.0	0.5781	1297.3	754.3	0.5814
9	1203.0	647.0	0.5378	1159.2	650.2	0.5609
10	1092.0	608.0	0.5568	1048.8	568.8	0.5424
11	959.0	455.0	0.4745	958.5	503.6	0.5254
12	877.0	447.0	0.5097	883.3	450.4	0.5099
13	782.0	398.0	0.509	819.7	406.3	0.4957
14	750.0	370.0	0.4933	765.2	369.2	0.4825
15	677.0	339.0	0.5007	718.1	337.7	0.4702
16	678.0	307.0	0.4528	676.8	310.6	0.4588
17	659.0	300.0	0.4552	640.5	287.1	0.4482
18	606.0	267.0	0.4406	608.3	266.6	0.4383
19	604.0	251.0	0.4156	579.4	248.5	0.4289
20	524.0	242.0	0.4618	553.5	232.6	0.4202
21	551.0	235.0	0.4265	530.1	218.3	0.4119
22	525.0	233.0	0.4438	508.8	205.6	0.4041
23	482.0	207.0	0.4295	489.5	194.2	0.3967
24	477.0	159.0	0.3333	471.7	183.9	0.3897
25	454.0	175.0	0.3855	455.5	174.5	0.3831
26	429.0	162.0	0.3776	440.5	166.0	0.3768
27	427.0	151.0	0.3536	426.6	158.2	0.3708
28	388.0	149.0	0.384	413.8	151.1	0.3651
29	417.0	132.0	0.3165	401.8	144.5	0.3597
30	412.0	138.0	0.335	390.7	138.5	0.3545
31	355.0	129.0	0.3634	380.3	133.0	0.3496
32	362.0	126.0	0.3481	370.7	127.8	0.3448
33	375.0	115.0	0.3067	361.6	123.1	0.3403
34	346.0	123.0	0.3555	353.1	118.6	0.336
35	363.0	109.0	0.3003	345.0	114.5	0.3318
36	328.0	121.0	0.3689	337.5	110.7	0.3278
37	351.0	122.0	0.3476	330.4	107.1	0.324
38	322.0	98.0	0.3043	323.7	103.7	0.3204
39	342.0	99.0	0.2895	317.3	100.5	0.3168
40	327.0	123.0	0.3761	311.3	97.6	0.3134
41	300.0	86.0	0.2867	305.7	94.8	0.3102
42	351.0	92.0	0.2621	300.3	92.2	0.307
43	283.0	90.0	0.318	295.2	89.7	0.304
44	307.0	87.0	0.2834	290.3	87.4	0.3011
45	268.0	103.0	0.3843	285.7	85.2	0.2983
46	285.0	92.0	0.3228	281.3	83.2	0.2956
47	260.0	77.0	0.2962	277.1	81.2	0.293
48	279.0	71.0	0.2545	273.1	79.3	0.2905
49	277.0	71.0	0.2563	269.3	77.6	0.2881
50	272.0	90.0	0.3309	265.7	75.9	0.2858
51	242.0	75.0	0.3099	262.2	74.3	0.2835
52	257.0	93.0	0.3619	258.9	72.8	0.2813
53	243.0	66.0	0.2716	255.8	71.4	0.2793
54	268.0	71.0	0.2649	252.7	70.1	0.2772
55	235.0	60.0	0.2553	249.9	68.8	0.2753
56	257.0	63.0	0.2451	247.1	67.6	0.2734
57	249.0	63.0	0.253	244.5	66.4	0.2716
58	257.0	63.0	0.2451	241.9	65.3	0.2699
59	223.0	59.0	0.2646	239.5	64.2	0.2682
60	225.0	70.0	0.3111	237.2	63.2	0.2666
61	245.0	70.0	0.2857	235.0	62.3	0.265
62	200.0	59.0	0.295	232.9	61.4	0.2635
63	217.0	73.0	0.3364	230.9	60.5	0.262
64	228.0	60.0	0.2632	228.9	59.7	0.2606
65	200.0	64.0	0.32	227.1	58.9	0.2593
66	244.0	57.0	0.2336	225.3	58.1	0.258
67	236.0	59.0	0.25	223.6	57.4	0.2567
68	216.0	63.0	0.2917	222.0	56.7	0.2555
69	243.0	60.0	0.2469	220.4	56.1	0.2544
70	215.0	55.0	0.2558	219.0	55.5	0.2533
71	201.0	69.0	0.3433	217.6	54.9	0.2522
72	203.0	64.0	0.3153	216.2	54.3	0.2512
73	175.0	43.0	0.2457	214.9	53.8	0.2502
74	190.0	56.0	0.2947	213.7	53.3	0.2493
75	209.0	46.0	0.2201	212.5	52.8	0.2484
76	233.0	49.0	0.2103	211.4	52.3	0.2475
77	219.0	38.0	0.1735	210.4	51.9	0.2467
78	205.0	58.0	0.2829	209.4	51.5	0.246
79	198.0	59.0	0.298	208.5	51.1	0.2452
80	207.0	64.0	0.3092	207.6	50.8	0.2445
81	207.0	48.0	0.2319	206.7	50.4	0.2439
82	166.0	43.0	0.259	205.9	50.1	0.2433
83	213.0	55.0	0.2582	205.2	49.8	0.2427
84	208.0	57.0	0.274	204.5	49.5	0.2421
85	213.0	49.0	0.23	203.9	49.3	0.2416
86	195.0	67.0	0.3436	203.2	49.0	0.2411
87	208.0	38.0	0.1827	202.7	48.8	0.2407
88	219.0	41.0	0.1872	202.2	48.6	0.2403
89	205.0	47.0	0.2293	201.7	48.4	0.2399
90	218.0	43.0	0.1972	201.3	48.2	0.2396
91	213.0	51.0	0.2394	200.9	48.1	0.2393
92	205.0	40.0	0.1951	200.5	47.9	0.239
93	218.0	37.0	0.1697	200.2	47.8	0.2387
94	194.0	41.0	0.2113	200.0	47.7	0.2385
95	207.0	57.0	0.2754	199.8	47.6	0.2383
96	202.0	45.0	0.2228	199.6	47.5	0.2382
97	200.0	55.0	0.275	199.4	47.5	0.2381
98	223.0	45.0	0.2018	199.3	47.4	0.238
99	211.0	49.0	0.2322	199.3	47.4	0.238
100	87.0	32.0	0.3678	99.6	23.7	0.2379

Caching results:
coth cache: CacheInfo(hits=7679184, misses=31986, maxsize=100000, currsize=31986)
erf cache: CacheInfo(hits=126802, misses=5781698, maxsize=100000, currsize=100000)
hyp1f1 cache: CacheInfo(hits=8954403, misses=6365214, maxsize=5000000, currsize=5000000)

Time taken: 0 hours, 18 minutes, 46.74 seconds
